
    <style>
        /* =========================================
           KUANDA GLOBAL DESIGN SYSTEM (ADMIN ADAPTATION)
           ========================================= */
        :root {
            --k-red: #E31C25;
            --k-red-dark: #B01018;
            --k-yellow: #FFC107;
            --k-black: #0F0F0F;
            --k-gray: #F3F4F6;
            --radius-md: 16px;
            --radius-lg: 24px;
            --shadow-md: 0 10px 15px -3px rgba(0, 0, 0, 0.05);
            --glass-bg: rgba(255, 255, 255, 0.85);
            --glass-blur: blur(12px);
            --kf-bg-dark: #09090b;
            --kf-text: #e4e4e7;
        }

        body {
            font-family: 'Plus Jakarta Sans', sans-serif;
            background-color: #FAFAFA;
            color: var(--k-black);
            padding-top: 100px;
            margin: 0;
            -webkit-font-smoothing: antialiased;
        }

        a { text-decoration: none !important; color: inherit; transition: 0.2s; }

        /* NAVBAR CAPSULE ADMIN */
        .nav-capsule {
            position: fixed; top: 20px; left: 50%; transform: translateX(-50%);
            width: 90%; max-width: 1200px; background: var(--glass-bg);
            backdrop-filter: var(--glass-blur); -webkit-backdrop-filter: var(--glass-blur);
            border: 1px solid rgba(255,255,255,0.5); border-radius: 100px;
            padding: 10px 25px; z-index: 1000; box-shadow: 0 10px 30px rgba(0,0,0,0.05);
            display: flex; align-items: center; justify-content: space-between;
        }

        /* KPI CARDS MODERN */
        .admin-card-kpi {
            background: white;
            border-radius: var(--radius-lg);
            padding: 24px;
            border: 1px solid rgba(0,0,0,0.03);
            box-shadow: var(--shadow-md);
            height: 100%;
            transition: transform 0.3s ease;
        }
        .admin-card-kpi:hover { transform: translateY(-5px); }
        .kpi-label { font-size: 0.75rem; font-weight: 700; color: #64748B; text-transform: uppercase; letter-spacing: 1px; }
        .kpi-value { font-size: 1.5rem; font-weight: 800; margin-top: 5px; color: var(--k-black); }
        .kpi-icon-circle {
            width: 45px; height: 45px; border-radius: 14px;
            display: flex; align-items: center; justify-content: center; font-size: 1.2rem;
        }

        /* DATA TABLES & PANELS */
        .glass-panel {
            background: white; border-radius: var(--radius-lg);
            padding: 30px; border: 1px solid rgba(0,0,0,0.03);
            box-shadow: var(--shadow-md); margin-bottom: 30px;
        }
        .panel-title { font-weight: 800; font-size: 1.2rem; letter-spacing: -0.5px; margin-bottom: 25px; display: flex; align-items: center; gap: 10px; }

        .table-kuanda { border-collapse: separate; border-spacing: 0 8px; width: 100%; }
        .table-kuanda thead th { background: #F8FAFC; padding: 15px; font-size: 0.7rem; font-weight: 800; color: #64748B; text-transform: uppercase; border: none; }
        .table-kuanda tbody tr { background: #fff; transition: 0.2s; }
        .table-kuanda tbody td { padding: 15px; font-size: 0.85rem; border-top: 1px solid #F1F5F9; border-bottom: 1px solid #F1F5F9; }
        .table-kuanda tbody td:first-child { border-left: 1px solid #F1F5F9; border-top-left-radius: 12px; border-bottom-left-radius: 12px; }
        .table-kuanda tbody td:last-child { border-right: 1px solid #F1F5F9; border-top-right-radius: 12px; border-bottom-right-radius: 12px; }

        /* BADGES */
        .badge-k { padding: 6px 12px; border-radius: 50px; font-size: 0.65rem; font-weight: 800; text-transform: uppercase; }
        .bg-k-pending { background: #FEF3C7; color: #92400E; }
        .bg-k-success { background: #DCFCE7; color: #166534; }
        .bg-k-error { background: #FEE2E2; color: #991B1B; }

        /* RANKING IMAGES */
        .rank-img { width: 40px; height: 40px; border-radius: 10px; object-fit: cover; }

        /* =========================================
           MOBILE DOCK & 3x3 MATRIX
           ========================================= */
        @media (max-width: 576px) {
            .nav-capsule { padding: 8px 15px; width: 95%; }
            .table-responsive { display: none; } /* Oculta tabela no mobile */

            /* MATRIZ 3x3 MINIATURIZADA */
            .admin-matrix-3x3 {
                display: grid !important;
                grid-template-columns: repeat(3, 1fr) !important;
                gap: 10px;
            }

            .mini-order-tile {
                background: #F8FAFC; padding: 10px 5px; border-radius: 15px;
                text-align: center; border: 1px solid #E2E8F0;
            }
            .mini-code { font-size: 0.6rem; font-weight: 800; color: var(--k-red); display: block; }
            .mini-shop { font-size: 0.65rem; font-weight: 700; display: block; height: 30px; overflow: hidden; margin: 4px 0; }
            .mini-price { font-size: 0.7rem; font-weight: 800; display: block; color: var(--k-black); }
            .mini-status-dot { width: 6px; height: 6px; border-radius: 50%; display: inline-block; margin-right: 3px; }
        }

        /* GAMER FOOTER INTEGRATION */
        .gamer-footer { background: var(--kf-bg-dark); color: var(--kf-text); padding: 50px 0 100px; margin-top: 50px; }
        .gf-title { font-weight: 800; font-size: 1.5rem; text-transform: uppercase; background: linear-gradient(90deg, #fff, #666); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        .gf-scroll-wrapper { display: flex; gap: 20px; overflow-x: auto; padding: 20px; scrollbar-width: none; }
        .game-card { min-width: 140px; height: 200px; border-radius: 12px; position: relative; overflow: hidden; border: 1px solid #27272a; }
        .game-img { width: 100%; height: 100%; object-fit: cover; opacity: 0.7; }
        .game-overlay { position: absolute; bottom: 0; padding: 10px; background: linear-gradient(to top, #000, transparent); width: 100%; color: white; font-size: 0.75rem; font-weight: 700; }
    </style>

    <!-- NAVBAR ADMIN CAPSULE -->
    <nav class="nav-capsule">
        <a href="/" class="d-flex align-items-center gap-2">
            <div class="rounded-circle bg-danger d-flex align-items-center justify-content-center text-white fw-bold" style="width: 35px; height: 35px;">K</div>
            <span class="fw-bold d-none d-sm-inline">AdminPanel</span>
        </a>
        
        <div class="d-flex gap-3 align-items-center">
            <a href="/admin" class="fw-bold small text-muted">Menu</a>
            <form action="/logout" method="POST" class="m-0">
                <button class="btn btn-dark btn-sm rounded-pill px-3 fw-bold">Sair</button>
            </form>
        </div>
    </nav>

    <div class="container-fluid px-lg-5">
        
        <!-- KPIs SECTION -->
        <div class="row g-4 mb-5">
            <div class="col-6 col-lg-3">
                <div class="admin-card-kpi">
                    <div class="d-flex justify-content-between align-items-start">
                        <div>
                            <span class="kpi-label">Receita Total</span>
                            <div class="kpi-value"><%= parseFloat(stats.receita_total).toLocaleString() %> <small>Kz</small></div>
                        </div>
                        <div class="kpi-icon-circle" style="background: #DCFCE7; color: #166534;"><i class="fas fa-wallet"></i></div>
                    </div>
                </div>
            </div>
            <div class="col-6 col-lg-3">
                <div class="admin-card-kpi">
                    <div class="d-flex justify-content-between align-items-start">
                        <div>
                            <span class="kpi-label">Pedidos</span>
                            <div class="kpi-value"><%= stats.total_pedidos %></div>
                        </div>
                        <div class="kpi-icon-circle" style="background: #E0F2FE; color: #0369A1;"><i class="fas fa-box"></i></div>
                    </div>
                </div>
            </div>
            <div class="col-6 col-lg-3">
                <div class="admin-card-kpi">
                    <div class="d-flex justify-content-between align-items-start">
                        <div>
                            <span class="kpi-label">Lojas</span>
                            <div class="kpi-value"><%= stats.total_vendedores %></div>
                        </div>
                        <div class="kpi-icon-circle" style="background: #FEF3C7; color: #92400E;"><i class="fas fa-store"></i></div>
                    </div>
                </div>
            </div>
            <div class="col-6 col-lg-3">
                <div class="admin-card-kpi">
                    <div class="d-flex justify-content-between align-items-start">
                        <div>
                            <span class="kpi-label">Ticket MÃ©dio</span>
                            <div class="kpi-value"><%= parseFloat(stats.ticket_medio).toFixed(0) %> <small>Kz</small></div>
                        </div>
                        <div class="kpi-icon-circle" style="background: #F1F5F9; color: #475569;"><i class="fas fa-chart-line"></i></div>
                    </div>
                </div>
            </div>
        </div>

        <div class="row g-4">
            <!-- PEDIDOS RECENTES -->
            <div class="col-lg-8">
                <div class="glass-panel">
                    <div class="panel-title">
                        <i class="fas fa-bolt text-warning"></i> Atividade de Vendas
                    </div>

                    <!-- Desktop View -->
                    <div class="table-responsive">
                        <table class="table-kuanda">
                            <thead>
                                <tr>
                                    <th>Ref</th>
                                    <th>Loja</th>
                                    <th>Cliente</th>
                                    <th>Total</th>
                                    <th>Status</th>
                                </tr>
                            </thead>
                            <tbody>
                                <% pedidos.forEach(p => { %>
                                    <tr>
                                        <td class="fw-800 text-danger">#<%= p.codigo || p.id %></td>
                                        <td class="fw-700"><%= p.nome_loja %></td>
                                        <td class="text-muted"><%= p.cliente_nome %></td>
                                        <td class="fw-800"><%= parseFloat(p.total).toLocaleString() %> Kz</td>
                                        <td>
                                            <% let st = (p.status === 'entregue') ? 'success' : (p.status === 'cancelado' ? 'error' : 'pending'); %>
                                            <span class="badge-k bg-k-<%= st %>"><%= p.status %></span>
                                        </td>
                                    </tr>
                                <% }) %>
                            </tbody>
                        </table>
                    </div>

                    <!-- Mobile Matrix 3x3 -->
                    <div class="admin-matrix-3x3 d-sm-none">
                        <% pedidos.forEach(p => { %>
                            <div class="mini-order-tile">
                                <span class="mini-code">#<%= p.codigo || p.id %></span>
                                <span class="mini-shop"><%= p.nome_loja %></span>
                                <span class="mini-price"><%= parseFloat(p.total).toLocaleString() %> Kz</span>
                                <span class="mini-status-dot" style="background: <%= p.status === 'entregue' ? '#22C55E' : '#EAB308' %>"></span>
                            </div>
                        <% }) %>
                    </div>
                </div>
            </div>

            <!-- RANKINGS SIDEBAR -->
            <div class="col-lg-4">
                <!-- TOP LOJAS -->
                <div class="glass-panel mb-4">
                    <div class="panel-title text-danger"><i class="fas fa-trophy"></i> Top Vendedores</div>
                    <% topLojas.forEach((loja, i) => { %>
                        <div class="d-flex align-items-center justify-content-between mb-3">
                            <div class="d-flex align-items-center gap-3">
                                <span class="fw-800 text-muted small">#<%= i+1 %></span>
                                <img src="/uploads/perfil/<%= loja.foto_perfil || 'default.png' %>" class="rank-img" onerror="this.src='https://via.placeholder.com/40'">
                                <div>
                                    <div class="fw-800 small text-truncate" style="max-width: 120px;"><%= loja.nome_loja %></div>
                                    <div class="text-muted" style="font-size: 0.65rem;"><%= loja.qtd_pedidos %> vendas</div>
                                </div>
                            </div>
                            <div class="fw-800 text-success small"><%= parseFloat(loja.total_vendido).toLocaleString() %> Kz</div>
                        </div>
                    <% }) %>
                </div>

                <!-- TOP PRODUTOS -->
                <div class="glass-panel">
                    <div class="panel-title text-primary"><i class="fas fa-fire"></i> + Procurados</div>
                    <% topProdutos.forEach((prod, i) => { %>
                        <div class="d-flex align-items-center justify-content-between mb-3">
                            <div class="d-flex align-items-center gap-3">
                                <span class="fw-800 text-muted small">#<%= i+1 %></span>
                                <img src="/uploads/produtos/<%= prod.imagem1 %>" class="rank-img" onerror="this.src='https://via.placeholder.com/40'">
                                <div class="fw-800 small text-truncate" style="max-width: 140px;"><%= prod.nome %></div>
                            </div>
                            <span class="badge bg-danger rounded-pill fw-800" style="font-size: 0.6rem;"><%= prod.total_vendido %> un</span>
                        </div>
                    <% }) %>
                </div>
            </div>
        </div>
    </div>


    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
